---
title: "Stats"
author: "Julia Prein"
date: "12/17/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load_packages, message=FALSE, warning=FALSE, include=FALSE}
library(tidyverse) # data handling etc.
library(viridis) # col scales, plotting...
library(ggpubr)
library(ggthemes)
library(tidyboot) # for bootstrap CIs
library(brms) # modeling
library(splithalfr) # reliability 

options(scipen = 999)
theme_set(theme_classic())
```

```{r load_data}
testtrials <- readRDS(file = "../data/gafo-testtrials.rds") %>% 
  # determine order of factors
  mutate(
    targetPosition = factor(targetPosition, levels = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "box1", "box2", "box3", "box4", "box5")), 
    studyversion = factor(studyversion, levels = c("hedge", "box")), 
    datacollection = factor(datacollection, levels = c("in-person - supervised", "remote - unsupervised")),
    sample = factor(sample, levels = c("kids", "adults")), 
    studytype = factor(studytype, levels = c("vali", "vali2", "reli"))
  )
```

# VARIATION

```{r vali_data}
vali <- testtrials %>% 
  filter(studytype == "vali" & (ageInYears < 6 | ageInYears == 18))
```

```{r variation_hedge_preparateData}
variationHedgeInd <- vali %>% 
  filter(studyversion == "hedge") %>% 
  mutate(
    ageInYearsExact = ifelse(sample == "kids", ageInMonths/12, 18), 
    ageInMonthsCentered = scale(ageInYearsExact, center = TRUE, scale = TRUE)[,1],
  ) %>% 
  group_by(sample, datacollection, ageInYears, ageInYearsExact, ageInMonthsCentered, subjID) %>%
  summarise(mean = mean(abs(clickDistFromTargetCenterX)/160, na.rm = TRUE))

variationHedge <- variationHedgeInd %>%
  group_by(sample, datacollection, ageInYears) %>%
  tidyboot_mean(column = mean)
```

```{r variation_hedge_plot}
tmp <- variationHedgeInd

variationHedgeInd <- variationHedgeInd %>% 
  mutate(
    ageInYears = factor(ageInYears, levels = c("3", "4", "5", "18"))
  )

hedge_variation_plot <- ggplot() +
  # child data
  geom_smooth(
    data = variationHedgeInd %>% filter(sample == "kids"),  
    aes(x = ageInYearsExact, y = mean, group = datacollection, lty = datacollection), 
    method = "lm", size = 0.5, alpha = 0.15, col = "darkgrey",
  ) + 
  
  geom_point(
    data = variationHedgeInd %>% filter(sample == "kids"), 
    aes(x = ageInYearsExact, y = mean, col = as.factor(ageInYears), shape = datacollection, alpha = datacollection)
  ) +
  
  geom_pointrange(
    data = variationHedge %>% filter(sample == "kids"), 
    aes(x = as.numeric(as.character(ageInYears))+.5, y = mean, ymin = ci_lower, ymax = ci_upper, col = as.factor(ageInYears), shape = datacollection, alpha = datacollection), size = 0.8, position=position_dodge(width = 0.1)
  ) +
  
  # scale_color_manual(values = c("#00b1ea", "#006c66", "#29485d"), labels = c("3-year-olds", "4-year-olds", "5-year-olds")) +
  scale_shape_manual(values = c(16, 18)) + 
  scale_alpha_discrete(range = c(1, 0.4)) + 
  scale_linetype_manual(values = c("solid", "dashed")) + 
  
  # adult data
  geom_jitter(
    data = variationHedgeInd %>% filter(sample == "adults"), 
    aes(x = 6.5, y = mean, col = as.factor(ageInYears), shape = datacollection), alpha = 0.8, width = .05, height = .01,  
  ) +

  geom_pointrange(
    data = variationHedge %>% filter(sample == "adults"), 
    aes(x = 6.5, y = mean, ymin = ci_lower, ymax = ci_upper, shape = datacollection), 
    size = 0.8,
  ) +
  
  labs(x = "Age in years", y = "Average imprecision in target width", col = "Age group", shape = "Data collection mode", alpha = "Data collection mode", lty = "Data collection mode") + 
  scale_color_manual(values = c("#00b1ea", "#006c66", "#29485d", "darkgrey"), breaks = c("3", "4", "5", "18"), labels = c("3-year-olds", "4-year-olds", "5-year-olds", "Adults")) +
  scale_y_continuous(limits = c(0, 5), breaks = seq(0, 5, 1)) + 
  scale_x_continuous(breaks = seq(3, 6.5, 0.5), labels = c("3.0", "3.5", "4.0", "4.5", "5.0", "5.5", "6.0", "Adults")) + 
  
  # theme(legend.text = element_text(size = 7),
  #       legend.key.size = unit(0.4, "cm"), 
  #       legend.direction = "vertical", 
  #       legend.position = c(0.89, 0.8), 
  #       legend.spacing.y = unit(0.25, 'cm'))

  theme(legend.text = element_text(size = 8),
        legend.key.size = unit(0.4, "cm"), 
        legend.direction = "vertical", 
        legend.box = "horizontal",
        legend.position = c(0.72, 0.85), 
        legend.background = element_blank(),
        legend.box.background = element_rect(colour = "black")
        )

hedge_variation_plot

ggsave("../figures/gafo_hedge_variation.png", width = 7, height = 4)
```

```{r variation_box_prepareData}
variationBoxInd <- vali %>% 
  filter(studyversion == "box") %>% 
  mutate(
    ageInYearsExact = ifelse(sample == "kids", ageInMonths/12, 18), 
    ageInMonthsCentered = scale(ageInYearsExact, center = TRUE, scale = TRUE)[,1],
  ) %>% 
  group_by(sample, datacollection, ageInYears, ageInYearsExact, ageInMonthsCentered, subjID) %>% 
  summarise(mean = mean(correctBox, na.rm = TRUE))

variationBox <- variationBoxInd %>%
  group_by(sample, datacollection, ageInYears) %>%
  tidyboot_mean(column = mean)
```

```{r variation_box_plot}
# with remote sample
box_variation_plot <- ggplot() +
  # chance level
  geom_segment(aes(x = 3.0, y = 0.2, xend = 6.2, yend = 0.2), lty = "dotted") + 
  geom_segment(aes(x = 6.25, y = 0.125, xend = 6.75, yend = 0.125), lty = "dotted") + 
  
  # child data
  geom_smooth(
    data = variationBoxInd %>% filter(sample == "kids"),  
    aes(x = ageInYearsExact, y = mean, group = datacollection, lty = datacollection), 
    method = "glm", size = 0.5, alpha = 0.15, col = "darkgrey",
  ) + 
  
  geom_point(
    data = variationBoxInd %>% filter(sample == "kids"), 
    aes(x = ageInYearsExact, y = mean, col = as.factor(ageInYears), shape = datacollection, alpha = datacollection)
  ) +
  
  geom_pointrange(
    data = variationBox %>% filter(sample == "kids"), 
    aes(x = as.numeric(as.character(ageInYears))+.5, y = mean, ymin = ci_lower, ymax = ci_upper, col = as.factor(ageInYears), shape = datacollection, alpha = datacollection), size = 0.8, position=position_dodge(width = 0.1)
  ) +
  
  scale_color_manual(values = c("#00b1ea", "#006c66", "#29485d"), labels = c("3-year-olds", "4-year-olds", "5-year-olds")) +
  scale_shape_manual(values = c(16, 18)) + 
  scale_alpha_discrete(range = c(1, 0.4)) + 
  scale_linetype_manual(values = c("solid", "dashed")) + 
  
  # adult data
  geom_jitter(
    data = variationBoxInd %>% filter(sample == "adults"), 
    aes(x = 6.5, y = mean, shape = datacollection), alpha = .15, width = .05, height = .01,  
  ) +

  geom_pointrange(
    data = variationBox %>% filter(sample == "adults"), 
    aes(x = 6.5, y = mean, ymin = ci_lower, ymax = ci_upper, shape = datacollection), 
    size = 0.8,
  ) +
  
  labs(x = "Age in years", y = "Proportion correct", col = "Age in years", shape = "Data collection mode", alpha = "Data collection mode", lty = "Data collection mode") + 
  scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.2)) + 
  scale_x_continuous(breaks = seq(3, 6.5, 0.5), labels = c("3.0", "3.5", "4.0", "4.5", "5.0", "5.5", "6.0", "Adults")) + 
  theme(legend.position="none")

box_variation_plot

ggsave("../figures/gafo_box_variation.png", width = 5, height = 4)
```

# RELI

```{r reli_data}
reli <- testtrials %>% 
  filter(studytype == "reli" & (ageInYears < 6 | ageInYears == 18) & completedReli == TRUE)

reli %>%
  group_by(subjID) %>%
  slice(1) %>%
  ungroup() %>% 
  select(ageInYears, studyversion) %>%
  ftable()
```

```{r intCon_hedge_data}
# take data of first reli day for internal consistency
hedge_intCon <- reli %>% 
  filter(studyversion == "hedge" & reliday == "reliday1") %>% 
  mutate(
    testhalf = ifelse(trialNr %% 2 == 0, "even_trials", "odd_trials")
  ) %>% 
  group_by(subjID, testhalf, sample, ageInYears) %>%
  tidyboot_mean(column = abs(clickDistFromTargetCenterX)/160, na.rm = TRUE)

hedge_intCon <- hedge_intCon %>% 
  select(-c(n, empirical_stat)) %>% 
  group_by(subjID, testhalf) %>%
  pivot_wider(
    names_from = testhalf,
    values_from = c(mean, ci_lower, ci_upper)
  ) %>%
  ungroup()

# summary
psych::describeBy(hedge_intCon, hedge_intCon$sample)
```

```{r intCon_hedge_kids}
hedge_intCon_kids <- hedge_intCon %>% 
  filter(sample == "kids") %>% 
  ggplot(., aes(x = mean_even_trials, y = mean_odd_trials)) + 
  geom_abline(intercept = 0, slope = 1, col = "darkgrey", linetype = "longdash") +
  geom_point(aes(col = as.factor(ageInYears)), size = 0.7) + 
  scale_color_manual(values = c("#00b1ea", "#006c66", "#29485d"), guide = "none") +
  geom_smooth(method = "lm", size = 0.5, alpha = 0.15, col = "darkgrey") +
  stat_cor(method = "pearson", label.x = 0, label.y = 5, aes(label = paste(..r.label..)), size = 3.5, r.accuracy = 0.01, cor.coef.name = "r") + 
  scale_x_continuous(limits = c(0, 5), breaks = seq(0, 5, 1)) +
  scale_y_continuous(limits = c(0, 5), breaks = seq(0, 5, 1)) +
  labs(x = "Even trials", y = "Odd trials")

hedge_intCon_kids

ggsave("../figures/gafo_hedge_intCon_kids.png", width = 6, height = 4)
```

```{r intCon_hedge_adults}
hedge_intCon_adults <- hedge_intCon %>% 
  filter(sample == "adults") %>% 
  ggplot(., aes(x = mean_even_trials, y = mean_odd_trials)) + 
  geom_abline(intercept = 0, slope = 1, col = "darkgrey", linetype = "longdash") +
  geom_point(col = "darkgrey", size = 1.2, shape = 18, alpha = 0.5) + 
  geom_smooth(method = "lm", size = 0.5, alpha = 0.15, col = "darkgrey") +
  stat_cor(method = "pearson", label.x = 0, label.y = 2, aes(label = paste(..r.label..)), size = 3.5, r.accuracy = 0.01, cor.coef.name = "r") + 
  scale_x_continuous(limits = c(0, 2), breaks = seq(0, 2, 0.5)) +
  scale_y_continuous(limits = c(0, 2), breaks = seq(0, 2, 0.5)) +
  labs(x = "Even trials", y = "Odd trials")

hedge_intCon_adults

ggsave("../figures/gafo_hedge_intCon_adults.png", width = 6, height = 4)
```

```{r splithalfr_hedge}
# fn_score_hedge <- function(ds) {
#   return(mean(abs(ds$clickDistFromTargetCenterX)/160, na.rm = TRUE))
# }
# 
# ### ODD EVEN
# split_scores_hedge_odd_even <- by_split(
#   hedge_intCon_data,
#   hedge_intCon_data$subjID,
#   fn_score_hedge,
#   replications = 1,
#   method = c("odd_even"),
# )
# 
# hedge_odd_even <- split_coefs(split_scores_hedge_odd_even, cor)
# hedge_odd_even_ci  <- split_ci(split_scores_hedge_odd_even, cor)
# 
# save_splithalf <- tibble(hedge_odd_even)
# 
# ### FIRST SECOND
# split_scores_hedge_first_second <- by_split(
#   hedge_intCon_data,
#   hedge_intCon_data$subjID,
#   fn_score_hedge,
#   replications = 1,
#   method = c("first_second"),
# )
# 
# hedge_first_second <- split_coefs(split_scores_hedge_first_second, cor)
# hedge_first_second_ci <- split_ci(split_scores_hedge_first_second, cor)
# 
# save_splithalf <- save_splithalf %>% 
#   mutate(
#     # add confidence interval of coefficients (bca: bias-corrected and accelerated bootstrap confidence intervals)
#     hedge_odd_even_ci_lower = hedge_odd_even_ci$lims["0.025","bca"],
#     hedge_odd_even_ci_upper = hedge_odd_even_ci$lims["0.975","bca"],
#     
#     # same for splitting according to first / second test half
#     hedge_first_second = hedge_first_second, 
#     hedge_first_second_ci_lower = hedge_first_second_ci$lims["0.025","bca"],
#     hedge_first_second_ci_upper = hedge_first_second_ci$lims["0.975","bca"],
#   )
```

```{r intCon_box_data}
# take data of first reli day for internal consistency
box_intCon <- reli %>% 
  filter(studyversion == "box" & reliday == "reliday1") %>% 
  mutate(
    testhalf = ifelse(trialNr %% 2 == 0, "even_trials", "odd_trials")
  ) %>% 
  group_by(subjID, testhalf, sample, ageInYears) %>%
  tidyboot_mean(column = correctBox, na.rm = TRUE)

box_intCon <- box_intCon %>% 
  select(-c(n, empirical_stat)) %>% 
  group_by(subjID, testhalf) %>%
  pivot_wider(
    names_from = testhalf,
    values_from = c(mean, ci_lower, ci_upper)
  ) %>%
  ungroup()

# summary
psych::describeBy(box_intCon, box_intCon$sample)
```

```{r intCon_box_kids}
box_intCon_kids <- box_intCon %>% 
  filter(sample == "kids") %>% 
  ggplot(., aes(x = mean_even_trials, y = mean_odd_trials)) + 
  geom_abline(intercept = 0, slope = 1, col = "darkgrey", linetype = "longdash") +
  geom_point(aes(col = as.factor(ageInYears)), size = 0.7) + 
  scale_color_manual(values = c("#00b1ea", "#006c66", "#29485d"), guide = "none") +
  geom_smooth(method = "lm", size = 0.5, alpha = 0.15, col = "darkgrey") +
  stat_cor(method = "pearson", label.x = 0, label.y = 1, aes(label = paste(..r.label..)), size = 3.5, r.accuracy = 0.01, cor.coef.name = "r") + 
  scale_x_continuous(breaks = seq(0, 1, 0.2)) +
  scale_y_continuous(breaks = seq(0, 1, 0.2)) +
  labs(x = "Even trials", y = "Odd trials")

box_intCon_kids

ggsave("../figures/gafo_box_intCon_kids.png", width = 6, height = 4)
```

```{r intCon_box_adults}
box_intCon_adults <- box_intCon %>% 
  filter(sample == "adults") %>% 
  ggplot(., aes(x = mean_even_trials, y = mean_odd_trials)) + 
  geom_abline(intercept = 0, slope = 1, col = "darkgrey", linetype = "longdash") +
  geom_point(col = "darkgrey", size = 1.2, shape = 18, alpha = 0.5) + 
  geom_smooth(method = "lm", size = 0.5, alpha = 0.15, col = "darkgrey") +
  stat_cor(method = "pearson", label.x = 0, label.y = 1, aes(label = paste(..r.label..)), size = 3.5, r.accuracy = 0.01, cor.coef.name = "r") + 
  scale_x_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.2)) +
  scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.2)) +
  labs(x = "Even trials", y = "Odd trials")

box_intCon_adults

ggsave("../figures/gafo_box_intCon_adults.png", width = 6, height = 4)
```

```{r box_splithalfr}
# fn_score_box <- function(ds) {
#   return(mean(ds$correctBox, na.rm = TRUE))
# }
# 
# ### ODD EVEN
# split_scores_box_odd_even <- by_split(
#   box_intCon_data,
#   box_intCon_data$subjID,
#   fn_score_box,
#   replications = 1,
#   method = c("odd_even"),
# )
# 
# box_odd_even = split_coefs(split_scores_box_odd_even, cor)
# box_odd_even_ci = split_ci(split_scores_box_odd_even, cor)
#   
# ### FIRST SECOND
# split_scores_box_first_second <- by_split(
#   box_intCon_data,
#   box_intCon_data$subjID,
#   fn_score_box,
#   replications = 1,
#   method = c("first_second"),
# )
# 
# box_first_second = split_coefs(split_scores_box_first_second, cor)
# box_first_second_ci = split_ci(split_scores_box_first_second, cor)
# 
# save_splithalf <- save_splithalf %>% 
#   mutate(
#     # add splitting according to odd / even test half
#     box_odd_even = box_odd_even, 
#     box_odd_even_ci_lower = box_odd_even_ci$lims["0.025","bca"],
#     box_odd_even_ci_upper = box_odd_even_ci$lims["0.975","bca"],
#     
#     # same for splitting according to first / second test half
#     box_first_second = box_first_second, 
#     box_first_second_ci_lower = box_first_second_ci$lims["0.025","bca"],
#     box_first_second_ci_upper = box_first_second_ci$lims["0.975","bca"],
#   )
```

```{r save_splithalfr}
# save_splithalf
# 
# write.csv(save_splithalf, "gafo-splithalf.csv", quote = F, row.names = F)
# saveRDS(save_splithalf, file = "gafo-splithalf.rds")
```

```{r retest_hedge_data}
# take data of first reli day for internal consistency
hedge_retest <- reli %>% 
  filter(studyversion == "hedge") %>% 
  group_by(subjID, reliday, sample, ageInYears) %>% 
  tidyboot_mean(column = abs(clickDistFromTargetCenterX)/160, na.rm = TRUE)

hedge_retest <- hedge_retest %>% 
  select(-c(n, empirical_stat)) %>% 
  group_by(subjID, reliday) %>%
  pivot_wider(
    names_from = reliday,
    values_from = c(mean, ci_lower, ci_upper)
  ) %>%
  ungroup()

# summary
psych::describeBy(hedge_retest, hedge_retest$sample)

# exclude 1 outlier
hedge_retest <- hedge_retest %>% 
  filter(mean_reliday1 < mean(mean_reliday1) + 3*sd(mean_reliday1), mean_reliday1 > mean(mean_reliday1) - 3*sd(mean_reliday1), 
         mean_reliday2 < mean(mean_reliday2) + 3*sd(mean_reliday2), mean_reliday2 > mean(mean_reliday2) - 3*sd(mean_reliday2))
```

```{r retest_hedge_kids}
hedge_retest_kids <- hedge_retest %>% 
  filter(sample == "kids") %>% 
  ggplot(., aes(x = mean_reliday1, y = mean_reliday2)) + 
  geom_abline(intercept = 0, slope = 1, col = "darkgrey", linetype = "longdash") +
  geom_point(aes(col = as.factor(ageInYears)), size = 0.7) + 
  scale_color_manual(values = c("#00b1ea", "#006c66", "#29485d"), guide = "none") +
  geom_smooth(method = "lm", size = 0.5, alpha = 0.15, col = "darkgrey") +
  stat_cor(method = "pearson", label.x = 0, label.y = 4, aes(label = paste(..r.label..)), size = 3.5, r.accuracy = 0.01, cor.coef.name = "r") + 
  scale_x_continuous(limits = c(0, 4), breaks = seq(0, 4, 1)) +
  scale_y_continuous(limits = c(0, 4), breaks = seq(0, 4, 1)) +
  labs(x = "Testday 1", y = "Testday 2")

hedge_retest_kids

ggsave("../figures/gafo_hedge_retest_kids.png", width = 6, height = 4)
```

```{r retest_hedge_adults}
hedge_retest_adults <- hedge_retest %>% 
  filter(sample == "adults") %>% 
  ggplot(., aes(x = mean_reliday1, y = mean_reliday2)) + 
  geom_abline(intercept = 0, slope = 1, col = "darkgrey", linetype = "longdash") +
  geom_point(col = "darkgrey", size = 1.2, shape = 18, alpha = 0.5) + 
  geom_smooth(method = "lm", size = 0.5, alpha = 0.15, col = "darkgrey") +
  stat_cor(method = "pearson", label.x = 0, label.y = 2, aes(label = paste(..r.label..)), size = 3.5, r.accuracy = 0.01, cor.coef.name = "r") + 
  scale_x_continuous(limits = c(0, 2), breaks = seq(0, 2, 0.5)) +
  scale_y_continuous(limits = c(0, 2), breaks = seq(0, 2, 0.5)) +
  labs(x = "Testday 1", y = "Testday 2")

hedge_retest_adults

ggsave("../figures/gafo_hedge_retest_adults.png", width = 6, height = 4)
```

```{r retest_box_data}
# take data of first reli day for internal consistency
box_retest <- reli %>% 
  filter(studyversion == "box") %>% 
  group_by(subjID, reliday, sample, ageInYears) %>% 
  tidyboot_mean(column = correctBox, na.rm = TRUE)

box_retest <- box_retest %>% 
  select(-c(n, empirical_stat)) %>% 
  group_by(subjID, reliday) %>%
  pivot_wider(
    names_from = reliday,
    values_from = c(mean, ci_lower, ci_upper)
  ) %>%
  ungroup()

# summary
psych::describeBy(box_retest, box_retest$sample)
```
```{r retest_box_kids}
box_retest_kids <- box_retest %>% 
  filter(sample == "kids") %>% 
  ggplot(., aes(x = mean_reliday1, y = mean_reliday2)) + 
  geom_abline(intercept = 0, slope = 1, col = "darkgrey", linetype = "longdash") +
  geom_point(aes(col = as.factor(ageInYears)), size = 0.7) + 
  scale_color_manual(values = c("#00b1ea", "#006c66", "#29485d"), guide = "none") +
  geom_smooth(method = "lm", size = 0.5, alpha = 0.15, col = "darkgrey") +
  stat_cor(method = "pearson", label.x = 0, label.y = 1, aes(label = paste(..r.label..)), size = 3.5, r.accuracy = 0.01, cor.coef.name = "r") + 
  scale_x_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.2)) +
  scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.2)) +
  labs(x = "Testday 1", y = "Testday 2")

box_retest_kids

ggsave("../figures/gafo_hedge_retest_kids.png", width = 6, height = 4)
```

```{r retest_box_adults}
box_retest_adults <- box_retest %>% 
  filter(sample == "adults") %>% 
  ggplot(., aes(x = mean_reliday1, y = mean_reliday2)) + 
  geom_abline(intercept = 0, slope = 1, col = "darkgrey", linetype = "longdash") +
  geom_point(col = "darkgrey", size = 1.2, shape = 18, alpha = 0.5) + 
  geom_smooth(method = "lm", size = 0.5, alpha = 0.15, col = "darkgrey") +
  stat_cor(method = "pearson", label.x = 0, label.y = 1, aes(label = paste(..r.label..)), size = 3.5, r.accuracy = 0.01, cor.coef.name = "r") + 
  scale_x_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.2)) +
  scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.2)) +
  labs(x = "Testday 1", y = "Testday 2")

box_retest_adults

ggsave("../figures/gafo_hedge_retest_adults.png", width = 6, height = 4)
```

```{r arrange_plots}
ggarrange(

  ggarrange(hedge_variation_plot,
            NULL,
            ggarrange(
              hedge_intCon_kids, 
              hedge_intCon_adults,
              hedge_retest_kids, 
              hedge_retest_adults, 
              nrow = 2, 
              ncol = 2, 
              labels = c("B", "C", "D", "E")
            ), 
            
            # hedge: space between vari and reli
            nrow = 1, widths = c(1.2, 0.06, 1),
            labels = c("A", "", "")
  ), 
  
  NULL, 
  
  ggarrange(box_variation_plot,
            NULL,
            ggarrange(
              box_intCon_kids,
              box_intCon_adults,
              box_retest_kids,
              box_retest_adults,
              nrow = 2, 
              ncol = 2,
              labels = c("G", "H", "I", "J")
            ), 
  
            # box: space between vari and reli
            nrow = 1, widths = c(1.2, 0.06, 1),
            labels = c("F", "", "")
  ), 
  
  # space between hedge & box
  nrow = 3, heights = c(1.2, 0.1, 1.2)
)

ggsave("../figures/gafo_results.png", width = 6.5, height = 5, scale = 1.6, bg = "white")
```
